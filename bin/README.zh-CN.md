# Dolphin å‘½ä»¤è¡Œå·¥å…·

**ä¸­æ–‡** | [English](./README.md)

---

è¿™æ˜¯ä¸€ä¸ªç”¨äºè¿è¡Œ Dolphin Language ç¨‹åºçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒå¤š Agent ç¯å¢ƒç®¡ç†ã€‚

## å®‰è£…

ç¡®ä¿ä½ å·²ç»å®‰è£…äº†æ‰€æœ‰å¿…è¦çš„ä¾èµ–ï¼š

```bash
pip install -r requirements.txt
```

## å¿«é€Ÿå¼€å§‹

```bash
# è¿è¡Œ Agent
dolphin run --agent my_agent --folder ./agents --query "ä½ çš„æŸ¥è¯¢"

# è°ƒè¯•æ¨¡å¼
dolphin debug --agent my_agent --folder ./agents

# äº¤äº’å¼å¯¹è¯
dolphin chat --agent my_agent --folder ./agents
```

## å­å‘½ä»¤

Dolphin CLI æä¾›ä¸‰ä¸ªå­å‘½ä»¤æ¥æ»¡è¶³ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼š

| å­å‘½ä»¤ | æè¿° | å…¸å‹ç”¨é€” |
|--------|------|----------|
| `run` | è¿è¡Œ Agentï¼ˆé»˜è®¤ï¼‰ | æ‰¹é‡æ‰§è¡Œã€è„šæœ¬è°ƒç”¨ |
| `debug` | è°ƒè¯•æ¨¡å¼ | å¼€å‘è°ƒè¯•ã€é—®é¢˜æ’æŸ¥ |
| `chat` | äº¤äº’å¼å¯¹è¯ | æŒç»­å¯¹è¯ã€æ¢ç´¢æµ‹è¯• |

---

## run å­å‘½ä»¤

æ­£å¸¸è¿è¡Œ Agentï¼Œæ‰§è¡Œå®Œæˆåé€€å‡ºã€‚

```bash
dolphin run --agent <agent_name> --folder <folder_path> [options]
```

### run ä¸“å±å‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `--timeout SECONDS` | æ‰§è¡Œè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œè¶…æ—¶åè‡ªåŠ¨ç»ˆæ­¢ |
| `--dry-run` | ä»…éªŒè¯é…ç½®å’Œ Agent å®šä¹‰ï¼Œä¸å®é™…æ‰§è¡Œ |
| `-i, --interactive` | äº¤äº’æ¨¡å¼ï¼šæ‰§è¡Œå®Œæˆåè¿›å…¥å¯¹è¯å¾ªç¯ |
| `--save-history` | ä¿å­˜å¯¹è¯å†å²åˆ°æ–‡ä»¶ï¼ˆé»˜è®¤å¼€å¯ï¼‰ |
| `--no-save-history` | ä¸ä¿å­˜å¯¹è¯å†å² |

### run ç¤ºä¾‹

```bash
# åŸºç¡€è¿è¡Œ
dolphin run --agent faq_extract --folder ./examples/dolphins --query "æå–FAQä¿¡æ¯"

# å¸¦è¶…æ—¶è¿è¡Œ
dolphin run --agent my_agent --folder ./agents --query "ä»»åŠ¡" --timeout 300

# ä»…éªŒè¯é…ç½®ï¼ˆä¸æ‰§è¡Œï¼‰
dolphin run --agent my_agent --folder ./agents --dry-run

# äº¤äº’æ¨¡å¼ï¼ˆæ‰§è¡Œåè¿›å…¥å¯¹è¯å¾ªç¯ï¼‰
dolphin run --agent my_agent --folder ./agents -i
```

---

## debug å­å‘½ä»¤

å¯åŠ¨äº¤äº’å¼è°ƒè¯•å™¨ï¼Œæ”¯æŒå•æ­¥æ‰§è¡Œã€æ–­ç‚¹ã€å˜é‡æ£€æŸ¥ç­‰åŠŸèƒ½ã€‚

```bash
dolphin debug --agent <agent_name> --folder <folder_path> [options]
```

### debug ä¸“å±å‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `--break-on-start` | åœ¨ç¬¬ä¸€ä¸ªä»£ç å—å°±æš‚åœ |
| `--break-at N` | åœ¨ç¬¬ N ä¸ªä»£ç å—è®¾ç½®æ–­ç‚¹ï¼ˆå¯å¤šæ¬¡ä½¿ç”¨ï¼‰ |
| `--snapshot-on-pause` | æ¯æ¬¡æš‚åœæ—¶è‡ªåŠ¨æ˜¾ç¤º ContextSnapshot æ‘˜è¦ |
| `--commands FILE` | ä»æ–‡ä»¶è¯»å–è°ƒè¯•å‘½ä»¤ï¼ˆæ¯è¡Œä¸€ä¸ªå‘½ä»¤ï¼‰ |
| `--auto-continue` | è‡ªåŠ¨ç»§ç»­æ¨¡å¼ï¼šä»…åœ¨æ–­ç‚¹å¤„æš‚åœï¼Œå…¶ä½™è‡ªåŠ¨æ‰§è¡Œ |
| `-i, --interactive` | äº¤äº’æ¨¡å¼ï¼šç¨‹åºæ‰§è¡Œå®Œæ¯•åè¿›å…¥å¯¹è¯å¾ªç¯ |

### debug ç¤ºä¾‹

```bash
# å¯åŠ¨è°ƒè¯•å¹¶åœ¨å¼€å§‹å¤„æš‚åœ
dolphin debug --agent my_agent --folder ./agents --break-on-start

# åœ¨å¤šä¸ªä½ç½®è®¾ç½®æ–­ç‚¹
dolphin debug --agent my_agent --folder ./agents --break-at 3 --break-at 7

# è‡ªåŠ¨æ˜¾ç¤ºå¿«ç…§ä¿¡æ¯
dolphin debug --agent my_agent --folder ./agents --snapshot-on-pause

# ä»æ–‡ä»¶è¯»å–è°ƒè¯•å‘½ä»¤ï¼ˆè‡ªåŠ¨åŒ–æµ‹è¯•ï¼‰
dolphin debug --agent my_agent --folder ./agents --commands ./debug_commands.txt
```

### è°ƒè¯•å‘½ä»¤è¯¦è§£

#### åŸºæœ¬æ‰§è¡Œæ§åˆ¶
- `step` (s): å•æ­¥æ‰§è¡Œä¸‹ä¸€ä¸ªå—
- `continue` (c): ç»§ç»­æ‰§è¡Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–ç¨‹åºç»“æŸ
- `quit` (q): é€€å‡ºè°ƒè¯•æ¨¡å¼

#### å˜é‡æŸ¥çœ‹
- `vars` (v): æ˜¾ç¤ºæ‰€æœ‰å˜é‡çŠ¶æ€
- `var <name>`: æ˜¾ç¤ºç‰¹å®šå˜é‡çš„è¯¦ç»†å†…å®¹

#### æ–­ç‚¹ç®¡ç†
- `break <n>`: åœ¨ç¬¬ n ä¸ªä»£ç å—è®¾ç½®æ–­ç‚¹
- `break`: æ˜¾ç¤ºå½“å‰æ‰€æœ‰å·²è®¾ç½®çš„æ–­ç‚¹åˆ—è¡¨

#### è°ƒè¯•ä¿¡æ¯
- `progress`: æ˜¾ç¤ºæ‰§è¡Œè¿›åº¦ä¿¡æ¯
- `help` (h): æ˜¾ç¤ºè°ƒè¯•å‘½ä»¤å¸®åŠ©ä¿¡æ¯

### è°ƒè¯•äº¤äº’ç¤ºä¾‹

```bash
ğŸ› è°ƒè¯•æ¨¡å¼å·²å¯ç”¨
ğŸ’¡ è¾“å…¥ 'help' æŸ¥çœ‹å¯ç”¨å‘½ä»¤

ğŸ¯ æš‚åœåœ¨å— #0
ğŸ“‹ å½“å‰å—ç±»å‹: InitBlock

Debug > vars          # æŸ¥çœ‹å½“å‰æ‰€æœ‰å˜é‡
ğŸ“ query: "æµ‹è¯•è°ƒè¯•"
ğŸ“ user_id: "12345"

Debug > step          # æ‰§è¡Œä¸‹ä¸€æ­¥
ğŸ¯ æš‚åœåœ¨å— #1
ğŸ“‹ å½“å‰å—ç±»å‹: LLMBlock

Debug > break 5       # åœ¨ç¬¬5ä¸ªå—è®¾ç½®æ–­ç‚¹
ğŸ”´ åœ¨å— #5 è®¾ç½®æ–­ç‚¹

Debug > continue      # ç»§ç»­æ‰§è¡Œåˆ°æ–­ç‚¹
ğŸ¯ æš‚åœåœ¨å— #5
ğŸ“‹ å½“å‰å—ç±»å‹: OutputBlock

Debug > quit          # é€€å‡ºè°ƒè¯•
ğŸ›‘ é€€å‡ºè°ƒè¯•æ¨¡å¼
```

---

## chat å­å‘½ä»¤

å¯åŠ¨æŒç»­å¯¹è¯æ¨¡å¼ï¼Œå¯ä»¥å¤šè½®äº¤äº’ç›´åˆ°é€€å‡ºã€‚

```bash
dolphin chat --agent <agent_name> --folder <folder_path> [options]
```

### chat ä¸“å±å‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `--system-prompt TEXT` | è‡ªå®šä¹‰ç³»ç»Ÿæç¤ºï¼ˆè¦†ç›–é»˜è®¤è®¾ç½®ï¼‰ |
| `--max-turns N` | æœ€å¤§å¯¹è¯è½®æ•°ï¼ˆè¾¾åˆ°åè‡ªåŠ¨é€€å‡ºï¼‰ |
| `--init-message TEXT` | åˆå§‹æ¶ˆæ¯ï¼ˆè‡ªåŠ¨å‘é€çš„ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼‰ |

### chat ç¤ºä¾‹

```bash
# å¯åŠ¨äº¤äº’å¯¹è¯
dolphin chat --agent chatbot --folder ./agents

# ä½¿ç”¨è‡ªå®šä¹‰ç³»ç»Ÿæç¤º
dolphin chat --agent my_agent --folder ./agents --system-prompt "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®åˆ†æå¸ˆ"

# é™åˆ¶å¯¹è¯è½®æ•°
dolphin chat --agent my_agent --folder ./agents --max-turns 10

# å‘é€åˆå§‹æ¶ˆæ¯å¼€å§‹å¯¹è¯
dolphin chat --agent my_agent --folder ./agents --init-message "åˆ†ææœ€æ–°çš„é”€å”®æ•°æ®"
```

---

## é€šç”¨å‚æ•°

ä»¥ä¸‹å‚æ•°é€‚ç”¨äºæ‰€æœ‰å­å‘½ä»¤ï¼š

### Agent ç›¸å…³å‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `-a, --agent NAME` | æŒ‡å®šå…¥å£ Agent åç§°ï¼ˆå¿…éœ€ï¼‰ |
| `--folder PATH` | æŒ‡å®šåŠ è½½çš„ Agent èŒƒå›´ç›®å½•ï¼ˆå¿…éœ€ï¼‰ |
| `--skill-folder PATH` | æŒ‡å®šè‡ªå®šä¹‰ Skillkit ç›®å½• |
| `-q, --query TEXT` | æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œä½œä¸º `query` å˜é‡ä¼ å…¥ç¨‹åº |

### é…ç½®ç›¸å…³å‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `-c, --config PATH` | é…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤: `./config/global.yaml`ï¼‰ |
| `--model-name NAME` | æ¨¡å‹åç§° (å¦‚: gpt-4, deepseek-chat) |
| `--api-key KEY` | API Key |
| `--api URL` | API ç«¯ç‚¹ URL |
| `--type-api TYPE` | API ç±»å‹ |
| `--user-id ID` | ç”¨æˆ· ID |
| `--session-id ID` | ä¼šè¯ ID |
| `--max-tokens N` | æœ€å¤§ token æ•°é‡ |
| `--temperature FLOAT` | æ¸©åº¦å‚æ•° (0.0-2.0) |

### æ—¥å¿—ä¸è¾“å‡ºå‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `-v, --verbose` | è¯¦ç»†è¾“å‡ºï¼ˆINFO çº§åˆ«æ—¥å¿—ï¼‰ |
| `-vv, --very-verbose` | éå¸¸è¯¦ç»†çš„è¾“å‡ºï¼ˆDEBUG çº§åˆ«æ—¥å¿—ï¼‰ |
| `--quiet` | å®‰é™æ¨¡å¼ï¼ˆä»… WARNING åŠä»¥ä¸Šï¼‰ |
| `--log-level LEVEL` | ç›´æ¥æŒ‡å®šæ—¥å¿—çº§åˆ«ï¼ˆDEBUG/INFO/WARNING/ERRORï¼‰ |
| `--log-suffix TEXT` | æ—¥å¿—æ–‡ä»¶ååç¼€ï¼ˆç”¨äºå¹¶å‘å®éªŒï¼‰ |
| `--output-variables VAR...` | æŒ‡å®šè¦è¾“å‡ºçš„å˜é‡ååˆ—è¡¨ |
| `--trajectory-path PATH` | å¯¹è¯å†å²ä¿å­˜è·¯å¾„ |
| `--trace-path PATH` | æ‰§è¡Œè½¨è¿¹ä¿å­˜è·¯å¾„ |

### Context Engineer å‚æ•°

| å‚æ•° | è¯´æ˜ |
|------|------|
| `--context-engineer-config PATH` | context-engineer é…ç½®æ–‡ä»¶è·¯å¾„ |
| `--context-engineer-data PATH` | context-engineer ä¸Šä¸‹æ–‡æ•°æ®æ–‡ä»¶è·¯å¾„ |

### è‡ªå®šä¹‰å‚æ•°

ä½ å¯ä»¥ä¼ é€’ä»»ä½•è‡ªå®šä¹‰å‚æ•°ï¼Œå®ƒä»¬å°†ä½œä¸ºå˜é‡ä¼ å…¥ç¨‹åºï¼š

```bash
dolphin run --agent analyzer --folder ./agents \
  --query "åˆ†ææ–‡æ¡£" \
  --doc_path "./data/report.pdf" \
  --output_format "json"
```

---

## Agent ç¯å¢ƒè¯´æ˜

1. **è‡ªåŠ¨æ‰«æ**: å·¥å…·ä¼šè‡ªåŠ¨æ‰«ææŒ‡å®šæ–‡ä»¶å¤¹ï¼ˆåŒ…æ‹¬å­æ–‡ä»¶å¤¹ï¼‰ä¸­çš„æ‰€æœ‰ `.dph` æ–‡ä»¶
2. **Agent æ³¨å†Œ**: æ¯ä¸ª `.dph` æ–‡ä»¶ä¼šè¢«æ³¨å†Œä¸ºä¸€ä¸ª Agentï¼ŒAgent åç§°åŸºäºæ–‡ä»¶å
3. **æŠ€èƒ½å…±äº«**: æ‰€æœ‰ Agent éƒ½å¯ä»¥è°ƒç”¨å…¶ä»– Agent ä½œä¸ºæŠ€èƒ½ä½¿ç”¨
4. **é‡åå¤„ç†**: å¦‚æœå‘ç°é‡åçš„ Agentï¼Œä¼šè‡ªåŠ¨æ·»åŠ æ•°å­—åç¼€åŒºåˆ†

### Agent æ–‡ä»¶å¤¹ç»“æ„ç¤ºä¾‹

```
agents/
â”œâ”€â”€ faq_extract.dph          # Agentåç§°: faq_extract
â”œâ”€â”€ document_analyzer.dph    # Agentåç§°: document_analyzer
â”œâ”€â”€ chatbot/
â”‚   â””â”€â”€ simple_chat.dph      # Agentåç§°: simple_chat
â””â”€â”€ tools/
    â”œâ”€â”€ web_search.dph       # Agentåç§°: web_search
    â””â”€â”€ file_processor.dph   # Agentåç§°: file_processor
```

---

## å¯æ‰§è¡Œæ¨¡å¼

ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œä½ å¯ä»¥ç›´æ¥è¿è¡Œè„šæœ¬ï¼š

```bash
./bin/dolphin run --agent my_agent --folder ./agents --query "ä½ çš„æŸ¥è¯¢"
```

---

## ç‰ˆæœ¬ä¿¡æ¯

```bash
dolphin --version
```

---

## æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶å­˜åœ¨æ€§**: ç¡®ä¿ Agent ç›®å½•å­˜åœ¨ä¸”å¯è¯»
2. **å·¥ä½œç›®å½•**: å¦‚æœä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œç¡®ä¿å½“å‰å·¥ä½œç›®å½•æ­£ç¡®
3. **API æƒé™**: æŸäº›æ¨¡å‹é…ç½®å‚æ•°å¯èƒ½éœ€è¦ç›¸åº”çš„ API è®¿é—®æƒé™
4. **å‚æ•°ä¼˜å…ˆçº§**: è‡ªå®šä¹‰å‚æ•°ä¼šè¦†ç›–åŒåçš„å†…ç½®å˜é‡
5. **Agent ä¾èµ–**: ç¡®ä¿ Agent ä¹‹é—´çš„ä¾èµ–å…³ç³»æ­£ç¡®é…ç½®
6. **é…ç½®æ–‡ä»¶**: é»˜è®¤é…ç½®æ–‡ä»¶è·¯å¾„ä¸º `./config/global.yaml`

---

## é”™è¯¯å¤„ç†

å·¥å…·æä¾›å®Œå–„çš„é”™è¯¯æç¤ºï¼š

- å‚æ•°éªŒè¯é”™è¯¯ï¼ˆå¦‚ä½¿ç”¨ `--agent` ä½†æœªæŒ‡å®š `--folder`ï¼‰
- æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¸å­˜åœ¨
- Agent ä¸å­˜åœ¨äºæŒ‡å®šæ–‡ä»¶å¤¹ä¸­
- DPH æ–‡ä»¶è¯­æ³•é”™è¯¯
- è¿è¡Œæ—¶å¼‚å¸¸

ä½¿ç”¨ `-v` æˆ– `-vv` å‚æ•°å¯ä»¥è·å¾—æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè°ƒè¯•è¾“å‡ºã€‚

---

## è°ƒè¯•æœ€ä½³å®è·µ

1. **é€æ­¥è°ƒè¯•æ–°ç¨‹åº**: å¯¹äºæ–°ç¼–å†™çš„ Dolphin ç¨‹åºï¼Œå»ºè®®ä½¿ç”¨ `step` å‘½ä»¤é€æ­¥æ‰§è¡Œï¼Œç¡®ä¿æ¯ä¸€æ­¥éƒ½æŒ‰é¢„æœŸè¿è¡Œ

2. **è®¾ç½®å…³é”®æ–­ç‚¹**: åœ¨é‡è¦çš„é€»è¾‘åˆ†æ”¯æˆ–å¤æ‚è®¡ç®—å‰è®¾ç½®æ–­ç‚¹ï¼Œæ–¹ä¾¿æ£€æŸ¥ç¨‹åºçŠ¶æ€

3. **ç›‘æ§å˜é‡å˜åŒ–**: ä½¿ç”¨ `vars` å‘½ä»¤æŒç»­ç›‘æ§å˜é‡å˜åŒ–ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸å€¼

4. **ç»„åˆä½¿ç”¨å‘½ä»¤**:
   - å…ˆç”¨ `vars` è·å–å˜é‡æ¦‚è§ˆ
   - å†ç”¨ `var <name>` æŸ¥çœ‹å…·ä½“å˜é‡è¯¦æƒ…
   - ç”¨ `progress` äº†è§£ç¨‹åºæ‰§è¡Œé˜¶æ®µ

5. **è°ƒè¯•å¤æ‚æµç¨‹**: å¯¹äºå¤š Agent äº¤äº’æˆ–å¤æ‚çš„æ‰§è¡Œæµç¨‹ï¼Œè°ƒè¯•æ¨¡å¼å¯ä»¥å¸®åŠ©ç†è§£ Agent é—´çš„æ•°æ®ä¼ é€’å’ŒçŠ¶æ€å˜åŒ–

### å˜é‡æ˜¾ç¤ºæ ¼å¼

- **ç®€å•æ¨¡å¼** (`vars` å‘½ä»¤):
  - å­—ç¬¦ä¸²ï¼šæ˜¾ç¤ºå‰100ä¸ªå­—ç¬¦ï¼Œè¿‡é•¿åˆ™æ·»åŠ  "..." çœç•¥å·
  - å¤åˆç±»å‹ï¼šæ˜¾ç¤ºä¸º `dict(é•¿åº¦: N)` æˆ– `list(é•¿åº¦: N)` æ ¼å¼
  - åŸºæœ¬ç±»å‹ï¼šç›´æ¥æ˜¾ç¤ºå€¼

- **è¯¦ç»†æ¨¡å¼** (`var <å˜é‡å>` å‘½ä»¤):
  - å®Œæ•´çš„ JSON æ ¼å¼å†…å®¹ï¼ŒåŒ…å«æ‰€æœ‰åµŒå¥—ç»“æ„
  - æ”¯æŒä¸­æ–‡å­—ç¬¦çš„æ­£ç¡®æ˜¾ç¤º
  - 2å±‚ç¼©è¿›çš„æ ¼å¼åŒ–è¾“å‡º

### è°ƒè¯•æ³¨æ„äº‹é¡¹

- è°ƒè¯•æ¨¡å¼ä¼šæ˜¾è‘—é™ä½ç¨‹åºæ‰§è¡Œé€Ÿåº¦ï¼Œä»…åœ¨å¼€å‘å’Œæµ‹è¯•é˜¶æ®µä½¿ç”¨
- å†…éƒ¨å˜é‡ï¼ˆä»¥ `_` å¼€å¤´ï¼‰é»˜è®¤ä¸æ˜¾ç¤ºï¼Œä¿æŒè°ƒè¯•ç•Œé¢æ•´æ´
- é•¿å­—ç¬¦ä¸²åœ¨ç®€å•æ¨¡å¼ä¸‹ä¼šè¢«æˆªæ–­ï¼Œä½¿ç”¨è¯¦ç»†æ¨¡å¼æŸ¥çœ‹å®Œæ•´å†…å®¹
- é€€å‡ºè°ƒè¯•æ¨¡å¼ä¼šåœæ­¢ç¨‹åºæ‰§è¡Œï¼Œè¯·åœ¨ç¡®è®¤ç¨‹åºçŠ¶æ€æ­£ç¡®åé€€å‡º

